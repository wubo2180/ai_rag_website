{% extends 'base.html' %}

{% block title %}ä¸ªäººèµ„æ–™ - {{ block.super }}{% endblock %}

{% block content %}
<div class="container" style="max-width: 800px; margin: 0 auto;">
    <div class="profile-header" style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <div style="display: flex; align-items: center; gap: 20px;">
            <div class="avatar" style="width: 80px; height: 80px; border-radius: 50%; background: #007bff; display: flex; align-items: center; justify-content: center; color: white; font-size: 32px; font-weight: bold;">
                {{ user.username|first|upper }}
            </div>
            <div>
                <h1 style="margin: 0; color: #333;">{{ user.username }}</h1>
                <p style="color: #666; margin: 5px 0;">{{ user.email }}</p>
                <p style="color: #999; font-size: 14px;">åŠ å…¥æ—¶é—´: {{ user.date_joined|date:"Yå¹´mæœˆdæ—¥" }}</p>
            </div>
        </div>
    </div>

    <div class="profile-content" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
        <!-- è´¦æˆ·ä¿¡æ¯ -->
        <div class="account-info" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 20px 0; color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px;">è´¦æˆ·ä¿¡æ¯</h3>
            
            <div class="info-item" style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                <label style="font-weight: bold; color: #555;">ç”¨æˆ·å:</label>
                <span style="margin-left: 10px;">{{ user.username }}</span>
            </div>
            
            <div class="info-item" style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                <label style="font-weight: bold; color: #555;">é‚®ç®±:</label>
                <span style="margin-left: 10px;">{{ user.email|default:"æœªè®¾ç½®" }}</span>
            </div>
            
            <div class="info-item" style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                <label style="font-weight: bold; color: #555;">å§“å:</label>
                <span style="margin-left: 10px;">{{ user.first_name }} {{ user.last_name|default:"" }}</span>
            </div>
            
            <div class="info-item" style="margin-bottom: 20px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                <label style="font-weight: bold; color: #555;">æœ€åç™»å½•:</label>
                <span style="margin-left: 10px;">{{ user.last_login|date:"Y-m-d H:i"|default:"ä»æœªç™»å½•" }}</span>
            </div>
            
            <a href="{% url 'edit_profile' %}" class="btn btn-primary" style="width: 100%; text-align: center;">ç¼–è¾‘èµ„æ–™</a>
        </div>

        <!-- ä½¿ç”¨ç»Ÿè®¡ -->
        <div class="usage-stats" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 20px 0; color: #333; border-bottom: 2px solid #28a745; padding-bottom: 10px;">ä½¿ç”¨ç»Ÿè®¡</h3>
            
            <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; margin-bottom: 10px; background: linear-gradient(135deg, #007bff, #6610f2); color: white; border-radius: 8px;">
                <div>
                    <div style="font-size: 24px; font-weight: bold;">{{ chat_sessions_count|default:0 }}</div>
                    <div style="font-size: 14px; opacity: 0.9;">å¯¹è¯ä¼šè¯</div>
                </div>
                <div style="font-size: 36px; opacity: 0.7;">ğŸ’¬</div>
            </div>
            
            <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; margin-bottom: 10px; background: linear-gradient(135deg, #28a745, #20c997); color: white; border-radius: 8px;">
                <div>
                    <div style="font-size: 24px; font-weight: bold;">{{ knowledge_count|default:0 }}</div>
                    <div style="font-size: 14px; opacity: 0.9;">çŸ¥è¯†æ¡ç›®</div>
                </div>
                <div style="font-size: 36px; opacity: 0.7;">ğŸ“š</div>
            </div>
            
            <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; margin-bottom: 20px; background: linear-gradient(135deg, #ffc107, #fd7e14); color: white; border-radius: 8px;">
                <div>
                    <div style="font-size: 24px; font-weight: bold;">{{ documents_count|default:0 }}</div>
                    <div style="font-size: 14px; opacity: 0.9;">ä¸Šä¼ æ–‡æ¡£</div>
                </div>
                <div style="font-size: 36px; opacity: 0.7;">ğŸ“„</div>
            </div>
            
            <a href="{% url 'change_password' %}" class="btn" style="width: 100%; text-align: center; background: #6c757d; color: white;">ä¿®æ”¹å¯†ç </a>
        </div>
    </div>

    <!-- æœ€è¿‘æ´»åŠ¨ -->
    <div class="recent-activity" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-top: 30px;">
        <h3 style="margin: 0 0 20px 0; color: #333; border-bottom: 2px solid #17a2b8; padding-bottom: 10px;">æœ€è¿‘æ´»åŠ¨</h3>
        
        {% if recent_sessions %}
            <div class="activity-list">
                {% for session in recent_sessions %}
                <div class="activity-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 5px; border-left: 4px solid #007bff;">
                    <div>
                        <div style="font-weight: bold; color: #333;">{{ session.title }}</div>
                        <div style="font-size: 12px; color: #666;">{{ session.messages.count }} æ¡æ¶ˆæ¯</div>
                    </div>
                    <div style="font-size: 12px; color: #999;">{{ session.updated_at|date:"m-d H:i" }}</div>
                </div>
                {% endfor %}
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <a href="{% url 'chat_index' %}" class="btn btn-primary">æŸ¥çœ‹æ‰€æœ‰å¯¹è¯</a>
            </div>
        {% else %}
            <div style="text-align: center; padding: 30px; color: #666;">
                <div style="font-size: 48px; margin-bottom: 10px;">ğŸ¤”</div>
                <p>è¿˜æ²¡æœ‰ä»»ä½•æ´»åŠ¨è®°å½•</p>
                <a href="{% url 'chat_index' %}" class="btn btn-primary">å¼€å§‹ç¬¬ä¸€æ¬¡å¯¹è¯</a>
            </div>
        {% endif %}
    </div>
</div>

<style>
@media (max-width: 768px) {
    .profile-content {
        grid-template-columns: 1fr !important;
    }
    
    .profile-header div:first-child {
        flex-direction: column !important;
        text-align: center !important;
    }
}
</style>
{% endblock %}